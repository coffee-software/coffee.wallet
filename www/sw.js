const CACHE_KEY = 'cache-v1';

//TODO automate: find . -print | awk '{ print "\""$0"\","}'
const CACHE_URLS = [
    './',
    "./index.html",
    "./vendor/pulltorefresh.min.js",
    "./vendor/range-slider.min.js",
    "./vendor/qrcode.js",
    "./vendor/btcjs.js",
    "./vendor/browserify.js",
    "./vendor/web3.min.js",
    "./js/widget.asset.js",
    "./js/changelog.js",
    "./js/coin.apis.web3js.js",
    "./js/widget.wallet.js",
    "./js/config.tpl.js",
    "./js/config.js",
    "./js/app.js",
    "./js/coin.apis.erc20.js",
    "./js/exchange.changelly.js",
    "./js/coin.apis.cmc.js",
    "./js/settings.js",
    "./js/airdrop.js",
    "./js/coin.apis.btcjs.js",
    "./js/exchange.base.js",
    "./js/exchange.uniswap.js",
    "./js/widget.coinbutton.js",
    "./js/coin.apis.js",
    "./js/database.js",
    "./js/price.providers.js",
    "./js/widget.select.js",
    "./js/exchange.now.js",
    "./js/fasttap.js",
    "./js/core.js",
    "./js/logger.js",
    "./js/exchange.js",
    "./plugins.js",
    "./cordova.js",
    "./cordova_plugins.js",
    "./font/Poppins-Italic.ttf",
    "./font/Poppins-Bold.ttf",
    "./font/Poppins-Regular.ttf",
    "./favicon.ico",
    "./css/ui.css",
    "./css/layout.css",
    "./css/index.css",
    "./coins/eos.svg",
    "./coins/poa.svg",
    "./coins/ppt.svg",
    "./coins/bab.svg",
    "./coins/ins.svg",
    "./coins/bsv.svg",
    "./coins/cred.svg",
    "./coins/arn.svg",
    "./coins/xpa.svg",
    "./coins/req.svg",
    "./coins/zil.svg",
    "./coins/edo.svg",
    "./coins/bts.svg",
    "./coins/gnt.svg",
    "./coins/cs.svg",
    "./coins/qrl.svg",
    "./coins/bdl.svg",
    "./coins/btcz.svg",
    "./coins/storm.svg",
    "./coins/mzc.svg",
    "./coins/pirl.svg",
    "./coins/ven.svg",
    "./coins/gto.svg",
    "./coins/$pac.svg",
    "./coins/bos.svg",
    "./coins/dent.svg",
    "./coins/mft.svg",
    "./coins/slr.svg",
    "./coins/btch.svg",
    "./coins/dock.svg",
    "./coins/mkr.svg",
    "./coins/pivx.svg",
    "./coins/mth.svg",
    "./coins/dcn.svg",
    "./coins/oax.svg",
    "./coins/link.svg",
    "./coins/theta.svg",
    "./coins/yoyow.svg",
    "./coins/veri.svg",
    "./coins/hight.svg",
    "./coins/btm.svg",
    "./coins/gup.svg",
    "./coins/eon.svg",
    "./coins/ary.svg",
    "./coins/ppc.svg",
    "./coins/vrsc.svg",
    "./coins/zen.svg",
    "./coins/gas.svg",
    "./coins/ong.svg",
    "./coins/bcd.svg",
    "./coins/vib.svg",
    "./coins/oot.svg",
    "./coins/cvc.svg",
    "./coins/frecnx.svg",
    "./coins/doge.svg",
    "./coins/rlc.svg",
    "./coins/d.svg",
    "./coins/xas.svg",
    "./coins/eth.test.svg",
    "./coins/mda.svg",
    "./coins/elf.svg",
    "./coins/prl.svg",
    "./coins/nexo.svg",
    "./coins/pax.svg",
    "./coins/tbx.svg",
    "./coins/bela.svg",
    "./coins/tgch.svg",
    "./coins/eop.svg",
    "./coins/dat.svg",
    "./coins/html.svg",
    "./coins/dcr.svg",
    "./coins/tnb.svg",
    "./coins/dash.svg",
    "./coins/vtc.svg",
    "./coins/xtz.svg",
    "./coins/colx.svg",
    "./coins/mds.svg",
    "./coins/inb.svg",
    "./coins/eth.svg",
    "./coins/ctxc.svg",
    "./coins/xmr.svg",
    "./coins/xlm.svg",
    "./coins/hot.svg",
    "./coins/wgr.svg",
    "./coins/iop.svg",
    "./coins/ngc.svg",
    "./coins/mln.svg",
    "./coins/sls.svg",
    "./coins/ok.svg",
    "./coins/drgn.svg",
    "./coins/mgo.svg",
    "./coins/lky.svg",
    "./coins/tel.svg",
    "./coins/agrs.svg",
    "./coins/elix.svg",
    "./coins/ant.svg",
    "./coins/xzc.svg",
    "./coins/mnx.svg",
    "./coins/zest.svg",
    "./coins/gvt.svg",
    "./coins/gzr.svg",
    "./coins/xmo.svg",
    "./coins/btcd.svg",
    "./coins/btcp.svg",
    "./coins/btx.svg",
    "./coins/wabi.svg",
    "./coins/nlc2.svg",
    "./coins/music.svg",
    "./coins/tau.svg",
    "./coins/aeon.svg",
    "./coins/smart.svg",
    "./coins/enj.svg",
    "./coins/nebl.svg",
    "./coins/msr.svg",
    "./coins/mana.svg",
    "./coins/yfi.svg",
    "./coins/crw.svg",
    "./coins/nmr.svg",
    "./coins/icx.svg",
    "./coins/nmc.svg",
    "./coins/wings.svg",
    "./coins/wbtc.svg",
    "./coins/lbc.svg",
    "./coins/rise.svg",
    "./coins/med.svg",
    "./coins/vet.svg",
    "./coins/btg.svg",
    "./coins/abt.svg",
    "./coins/ncash.svg",
    "./coins/burst.svg",
    "./coins/xuc.svg",
    "./coins/fun.svg",
    "./coins/miota.svg",
    "./coins/eca.svg",
    "./coins/cel.svg",
    "./coins/btc.svg",
    "./coins/nlg.svg",
    "./coins/gbx.svg",
    "./coins/matic.svg",
    "./coins/pasl.svg",
    "./coins/gsc.svg",
    "./coins/2give.svg",
    "./coins/lkk.svg",
    "./coins/xdn.svg",
    "./coins/shift.svg",
    "./coins/dnt.svg",
    "./coins/cft.svg",
    "./coins/jnt.svg",
    "./coins/lend.svg",
    "./coins/bcn.svg",
    "./coins/entrp.svg",
    "./coins/hush.svg",
    "./coins/wtc.svg",
    "./coins/nano.svg",
    "./coins/lpt.svg",
    "./coins/cdt.svg",
    "./coins/qash.svg",
    "./coins/band.svg",
    "./coins/aion.svg",
    "./coins/nas.svg",
    "./coins/cmm.svg",
    "./coins/dth.svg",
    "./coins/bsd.svg",
    "./coins/xrp.svg",
    "./coins/dew.svg",
    "./coins/part.svg",
    "./coins/noicon.svg",
    "./coins/ink.svg",
    "./coins/iotx.svg",
    "./coins/rads.svg",
    "./coins/neos.svg",
    "./coins/pay.svg",
    "./coins/appc.svg",
    "./coins/gmr.svg",
    "./coins/vrc.svg",
    "./coins/tnc.svg",
    "./coins/beam.svg",
    "./coins/ast.svg",
    "./coins/rap.svg",
    "./coins/data.svg",
    "./coins/bnb.svg",
    "./coins/clam.svg",
    "./coins/erc20.tst.svg",
    "./coins/dlt.svg",
    "./coins/trtl.svg",
    "./coins/sc.svg",
    "./coins/plr.svg",
    "./coins/ryo.svg",
    "./coins/r.svg",
    "./coins/ilk.svg",
    "./coins/cnx.svg",
    "./coins/zcl.svg",
    "./coins/ont.svg",
    "./coins/utk.svg",
    "./coins/loom.svg",
    "./coins/xmg.svg",
    "./coins/tzc.svg",
    "./coins/rcn.svg",
    "./coins/wpr.svg",
    "./coins/dtr.svg",
    "./coins/bay.svg",
    "./coins/xcp.svg",
    "./coins/tpay.svg",
    "./coins/qsp.svg",
    "./coins/pasc.svg",
    "./coins/adx.svg",
    "./coins/zel.svg",
    "./coins/srn.svg",
    "./coins/mith.svg",
    "./coins/taas.svg",
    "./coins/lun.svg",
    "./coins/aeur.svg",
    "./coins/omni.svg",
    "./coins/pre.svg",
    "./coins/fldc.svg",
    "./coins/atom.svg",
    "./coins/ltc.svg",
    "./coins/gbyte.svg",
    "./coins/amb.svg",
    "./coins/usdc.svg",
    "./coins/ost.svg",
    "./coins/sub.svg",
    "./coins/wicc.svg",
    "./coins/fair.svg",
    "./coins/via.svg",
    "./coins/edoge.svg",
    "./coins/cnd.svg",
    "./coins/sib.svg",
    "./coins/edg.svg",
    "./coins/xsg.svg",
    "./coins/atm.svg",
    "./coins/game.svg",
    "./coins/maid.svg",
    "./coins/bat.svg",
    "./coins/ae.svg",
    "./coins/npxs.svg",
    "./coins/arg.svg",
    "./coins/brd.svg",
    "./coins/payx.svg",
    "./coins/ppp.svg",
    "./coins/ark.svg",
    "./coins/xmy.svg",
    "./coins/bcpt.svg",
    "./coins/aoa.svg",
    "./coins/dbc.svg",
    "./coins/nuls.svg",
    "./coins/ftc.svg",
    "./coins/polis.svg",
    "./coins/sphtx.svg",
    "./coins/dta.svg",
    "./coins/sbd.svg",
    "./coins/rhoc.svg",
    "./coins/poly.svg",
    "./coins/comp.svg",
    "./coins/fjc.svg",
    "./coins/ht.svg",
    "./coins/etn.svg",
    "./coins/cro.svg",
    "./coins/dot.svg",
    "./coins/zrx.svg",
    "./coins/itc.svg",
    "./coins/fsn.svg",
    "./coins/xmcc.svg",
    "./coins/mcap.svg",
    "./coins/steem.svg",
    "./coins/xpm.svg",
    "./coins/mod.svg",
    "./coins/crpt.svg",
    "./coins/wan.svg",
    "./coins/start.svg",
    "./coins/exp.svg",
    "./coins/dai.svg",
    "./coins/rvn.svg",
    "./coins/omg.svg",
    "./coins/act.svg",
    "./coins/tkn.svg",
    "./coins/algo.svg",
    "./coins/icn.svg",
    "./coins/nav.svg",
    "./coins/fil.svg",
    "./coins/bix.svg",
    "./coins/hodl.svg",
    "./coins/klown.svg",
    "./coins/chips.svg",
    "./coins/blk.svg",
    "./coins/cdn.svg",
    "./coins/qkc.svg",
    "./coins/ode.svg",
    "./coins/vtho.svg",
    "./coins/rdn.svg",
    "./coins/bpt.svg",
    "./coins/neo.svg",
    "./coins/sumo.svg",
    "./coins/chat.svg",
    "./coins/iq.svg",
    "./coins/grin.svg",
    "./coins/ren.svg",
    "./coins/tomo.svg",
    "./coins/sai.svg",
    "./coins/strat.svg",
    "./coins/xbp.svg",
    "./coins/knc.svg",
    "./coins/xby.svg",
    "./coins/agi.svg",
    "./coins/neu.svg",
    "./coins/amp.svg",
    "./coins/iost.svg",
    "./coins/vivo.svg",
    "./coins/ella.svg",
    "./coins/zec.svg",
    "./coins/elec.svg",
    "./coins/spank.svg",
    "./coins/ada.svg",
    "./coins/xp.svg",
    "./coins/cmt.svg",
    "./coins/snx.svg",
    "./coins/btc.test.svg",
    "./coins/meetone.svg",
    "./coins/pot.svg",
    "./coins/nio.svg",
    "./coins/grs.svg",
    "./coins/ion.svg",
    "./coins/qlc.svg",
    "./coins/huc.svg",
    "./coins/vibe.svg",
    "./coins/ten.svg",
    "./coins/trig.svg",
    "./coins/tern.svg",
    "./coins/dgd.svg",
    "./coins/ebst.svg",
    "./coins/hpb.svg",
    "./coins/qtum.svg",
    "./coins/cc.svg",
    "./coins/rep.svg",
    "./coins/stq.svg",
    "./coins/bnty.svg",
    "./coins/btt.svg",
    "./coins/mtl.svg",
    "./coins/waves.svg",
    "./coins/wax.svg",
    "./coins/flo.svg",
    "./coins/rev.svg",
    "./coins/ubq.svg",
    "./coins/storj.svg",
    "./coins/bco.svg",
    "./coins/eqli.svg",
    "./coins/tnt.svg",
    "./coins/lrc.svg",
    "./coins/call.svg",
    "./coins/poe.svg",
    "./coins/etc.svg",
    "./coins/kcs.svg",
    "./coins/ela.svg",
    "./coins/sys.svg",
    "./coins/kin.svg",
    "./coins/tusd.svg",
    "./coins/emc.svg",
    "./coins/emc2.svg",
    "./coins/ardr.svg",
    "./coins/dgb.svg",
    "./coins/gin.svg",
    "./coins/ignis.svg",
    "./coins/mco.svg",
    "./coins/evx.svg",
    "./coins/sky.svg",
    "./coins/stx.svg",
    "./coins/ox.svg",
    "./coins/fct.svg",
    "./coins/xem.svg",
    "./coins/cloak.svg",
    "./coins/gno.svg",
    "./coins/auto.svg",
    "./coins/bch.svg",
    "./coins/sngls.svg",
    "./coins/moac.svg",
    "./coins/cob.svg",
    "./coins/pink.svg",
    "./coins/snm.svg",
    "./coins/drop.svg",
    "./coins/blz.svg",
    "./coins/xvg.svg",
    "./coins/san.svg",
    "./coins/trx.svg",
    "./coins/now.svg",
    "./coins/0xbtc.svg",
    "./coins/soc.svg",
    "./coins/bnt.svg",
    "./coins/stak.svg",
    "./coins/nxs.svg",
    "./coins/kmd.svg",
    "./coins/uni.svg",
    "./coins/block.svg",
    "./coins/leo.svg",
    "./coins/snt.svg",
    "./coins/sin.svg",
    "./coins/usdt.svg",
    "./coins/salt.svg",
    "./coins/krb.svg",
    "./coins/rdd.svg",
    "./coins/mona.svg",
    "./coins/zilla.svg",
    "./coins/lsk.svg",
    "./coins/safe.svg",
    "./coins/eng.svg",
    "./coins/btdx.svg",
    "./coins/pura.svg",
    "./coins/actn.svg",
    "./coins/etp.svg",
    "./coins/fuel.svg",
    "./coins/xin.svg",
    "./coins/xbc.svg",
    "./coins/gusd.svg",
    "./coins/grc.svg",
    "./coins/tks.svg",
    "./coins/tix.svg",
    "./coins/ethos.svg",
    "./coins/nxt.svg",
    "./coins/powr.svg",
    "./coins/gxs.svg",
    "./coins/bq.svg",
    "./icons/refresh.png",
    "./icons/money.png",
    "./icons/tools.png",
    "./icons/ico.copy.png",
    "./icons/export.png",
    "./icons/quickscan.png",
    "./icons/send.png",
    "./icons/check.png",
    "./icons/sendglyph.png",
    "./icons/togglecam.png",
    "./icons/submit.png",
    "./icons/messageglyph.png",
    "./icons/add.png",
    "./icons/email.png",
    "./icons/customize.png",
    "./icons/quickpaste.png",
    "./icons/ico.set.png",
    "./icons/sendall.png",
    "./icons/msgtype.png",
    "./icons/bullet.png",
    "./icons/twitter.png",
    "./icons/message.png",
    "./icons/slideron.png",
    "./icons/import.png",
    "./icons/ico.send.png",
    "./icons/ico.cancel.png",
    "./icons/yes.png",
    "./icons/history.png",
    "./icons/paste.png",
    "./icons/cancel.png",
    "./icons/about.png",
    "./icons/exchange.png",
    "./icons/scan.png",
    "./icons/shapeshift.png",
    "./icons/slider.png",
    "./icons/receive.png",
    "./icons/submit.copy.png",
    "./icons/settings.png",
    "./icons/ico.add.png",
    "./icons/no.png",
    "./icons/close.png",
    "./icons/heart.png",
    "./icons/buy.png",
    "./icons/refreshall.png",
    "./icons/removef.png",
    "./icons/ok.png",
    "./icons/share.png",
    "./icons/home.png",
    "./icons/coinbg.png",
    "./icons/reddit.png",
    "./icons/txt.png",
    "./icons/more.png",
    "./icons/select.png",
    "./icons/nonet.png",
    "./icons/help.png",
    "./icons/sell.png",
    "./icons/edit.png",
    "./icons/menu.png",
    "./icons/telegram.png",
    "./icons/plus.png",
    "./icons/link.png",
    "./icons/tick.png",
    "./icons/list.png",
    "./icons/hide.png",
    "./icons/stitch.png",
    "./icons/submit.send.png",
    "./icons/remove.png",
    "./icons/hide.drk.png",
    "./icons/refreshpull.png",
    "./img/logo.png",
    "./img/exchanges/now.png",
    "./img/exchanges/uniswap.test.png",
    "./img/exchanges/uniswap.png",
    "./img/exchanges/changelly.png",
    "./img/loading.svg",
    "./img/help1.png",
    "./img/stitch.png",
    "./plugins/cordova-plugin-device/www/device.js",
    "./plugins/cordova-plugin-device/src/browser/DeviceProxy.js",
    "./plugins/eeschiavo-cordova-plugin-clipboard/www/clipboard.js",
    "./plugins/cordova-plugin-splashscreen/www/splashscreen.js",
    "./plugins/cordova-plugin-splashscreen/src/browser/SplashScreenProxy.js",
    "./plugins/cordova-plugin-dialogs/www/notification.js",
    "./plugins/cordova-plugin-dialogs/www/browser/notification.js",
    "./plugins/cordova-clipboard/www/clipboard.js",
    "./plugins/cordova-pdf-generator/www/pdf.js",
    "./plugins/cordova-plugin-android-fingerprint-auth/www/FingerprintAuth.js",
    "./plugins/cordova-plugin-touch-id/www/TouchID.js",
    "./plugins/es6-promise-plugin/www/promise.js",
    "./plugins/cordova-plugin-nativestorage/www/NativeStorageError.js",
    "./plugins/cordova-plugin-nativestorage/www/mainHandle.js",
    "./plugins/cordova-plugin-nativestorage/www/LocalStorageHandle.js",
    "./plugins/cordova-plugin-statusbar/www/statusbar.js",
    "./plugins/cordova-plugin-statusbar/src/browser/StatusBarProxy.js",
    "./plugins/phonegap-plugin-barcodescanner/www/barcodescanner.js",
    "./plugins/phonegap-plugin-barcodescanner/src/browser/BarcodeScannerProxy.js",
    "./plugins/cordova-plugin-x-socialsharing/www/SocialSharing.js",
    "./plugins/cordova-plugin-inappbrowser/www/inappbrowser.js",
    "./plugins/cordova-plugin-inappbrowser/src/browser/InAppBrowserProxy.js",
    "./pwa/icon.png",
    "./config.xml",
    "./cordova-js-src/platform.js",
    "./cordova-js-src/exec.js",
    "./cordova-js-src/confighelper.js",
    "./sw.js",
    "./manifest.json"
];

self.addEventListener('install', event => {
console.log('install');
  event.waitUntil(
    caches.open(CACHE_KEY)
      .then(cache => cache.addAll(CACHE_URLS))
      .then(self.skipWaiting())
  );
});

self.addEventListener('activate', event => {
  event.waitUntil(
    caches.keys().then(cacheNames => {
      return cacheNames.filter(cacheName => cacheName != CACHE_KEY);
    }).then(cachesToDelete => {
      return Promise.all(cachesToDelete.map(cacheToDelete => {
        return caches.delete(cacheToDelete);
      }));
    }).then(() => self.clients.claim())
  );
});

self.addEventListener('fetch', event => {
console.log('fetch', event.request.url);
  if (event.request.url.startsWith(self.location.origin)) {
    event.respondWith(
      caches.match(event.request).then(cachedResponse => {
        if (cachedResponse) {
          return cachedResponse;
        }
      })
    );
  }
});